
1)

UPDATE DEBITOS d
SET d.SITUACAO_DEBITO = 'ATRASADO'
WHERE d.DATAVENCIMENTO < CURRENT_DATE
AND d.SITUACAO_DEBITO <> 'NEGOCIADO'
AND d.SITUACAO_DEBITO <> 'PAGO'

2)

UPDATE DEBITOS d SET d.SITUACAO_DEBITO  = 'PENDENTE'
WHERE d.DATAVENCIMENTO >= CURRENT_DATE
AND d.SITUACAO_DEBITO <>'PAGO'

3)

UPDATE DEBITOS D
SET DATAVENCIMENTO  = DATEADD(YEAR, -5, DATAVENCIMENTO)
WHERE D.SITUACAO_DEBITO = 'NEGOCIADO'

4)

SELECT p.NOME, p.EMAIL, p.TELEFONE
FROM PESSOA p 

5)

SELECT p.NOME
FROM PRODUTO p 
WHERE p.PRECO_UNITARIO > 100

6)

SELECT 	v.ID_VENDA 
FROM VENDA v 
WHERE v.DATA_VENDA = '2022-10-30'

7)

SELECT p.NOME, p.DATA_NASCIMENTO, EXTRACT (YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM p.DATA_NASCIMENTO) AS IDADE FROM FORNECEDOR f 
LEFT JOIN PESSOA p ON f.ID_PESSOA = p.ID_PESSOA 
LEFT JOIN PRODUTO p2 ON f.ID_FORNECEDOR = p2.ID_FORNECEDOR
WHERE p2.ID_FORNECEDOR IS NULL

8)

SELECT c.ID_CLIENTE 
FROM CLIENTE c
WHERE c.ID_CLIENTE IN (SELECT d.ID_CLIENTE FROM	DEBITOS d WHERE d.SITUACAO_DEBITO LIKE 'ATRASADO')

9...

10)
SELECT d.ID_CLIENTE,
       p.NOME,
       (EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM p.DATA_NASCIMENTO)) AS IDADE,
       (SELECT SUM(d2.VALOR_TOTAL)
    FROM DEBITOS d2
    WHERE d2.ID_CLIENTE = d.ID_CLIENTE
    AND d2.DATAVENCIMENTO < CURRENT_DATE) AS DEBITO_VENCIDO,
   COALESCE ((SELECT SUM(d3.VALOR_TOTAL)
    FROM DEBITOS d3
    WHERE d3.ID_CLIENTE = d.ID_CLIENTE
    AND d3.SITUACAO_DEBITO = 'Pago'), 0) AS DEBITO_PAGO
FROM DEBITOS d
LEFT JOIN CLIENTE c ON c.ID_CLIENTE = d.ID_CLIENTE
LEFT JOIN PESSOA p ON p.ID_PESSOA = c.ID_PESSOA
GROUP BY d.ID_CLIENTE, p.NOME, IDADE
ORDER BY DEBITO_VENCIDO DESC
ROWS 10


11)

UPDATE PRODUTO p
SET p.PRECO_UNITARIO = p.PRECO_UNITARIO * 1.10
WHERE p.QUANTIDADE_ESTOQUE < 10

12...

UPDATE VENDA v
SET v. = 'Concluído'
WHERE DATA_VENDA < '2024-01-01'

13)

UPDATE  DEBITOS D
SET  d.SITUACAO_DEBITO = 'Pago'
WHERE d.SITUACAO_DEBITO = 'Atrasado'
AND d.ID_DEBITO IN (SELECT p.ID_DEBITO FROM PAGAMENTO p)


15)

SELECT v.*
FROM VENDA v 
WHERE v.DATA_VENDA BETWEEN '2023-12-01' AND '2024-01-31'

16)

SELECT p.*
FROM PRODUTO p
WHERE p.QUANTIDADE_ESTOQUE BETWEEN 5 AND 20

17)

SELECT p.*
FROM PESSOA p
WHERE p.NOME LIKE 'A%'

18)

SELECT p.*
FROM PRODUTO p 
WHERE ID_PRODUTO NOT IN (SELECT ID_PRODUTO FROM ITENSVENDA i) 

19)

SELECT 
    p.NOME,
    prod.NOME,
    iv.QUANTIDADE,
    iv.VALOR_UNITARIO
FROM CLIENTE c
JOIN PESSOA p ON c.ID_PESSOA = p.ID_PESSOA
JOIN VENDA v ON v.ID_PESSOA = c.ID_PESSOA
JOIN ITENSVENDA iv ON iv.ID_VENDA = v.ID_VENDA
JOIN PRODUTO prod ON iv.ID_PRODUTO = prod.ID_PRODUTO
WHERE p.NOME IN ('Carla Souza', 'Larissa Ferreira')

20)

SELECT DISTINCT p.ID_PESSOA, p.NOME, p.EMAIL, p.TELEFONE
FROM PESSOA p
LEFT JOIN CLIENTE c ON p.ID_PESSOA = c.ID_PESSOA
LEFT JOIN FORNECEDOR f ON p.ID_PESSOA = f.ID_PESSOA
WHERE c.ID_CLIENTE IS NOT NULL OR f.ID_FORNECEDOR IS NOT NULL

21)

SELECT v.*
FROM VENDA v
JOIN CLIENTE c ON v.ID_PESSOA = c.ID_PESSOA
JOIN PESSOA p ON c.ID_PESSOA = p.ID_PESSOA
JOIN FORMA_PAGAMENTO fp ON v.ID_FORMA_PAGAMENTO = fp.ID_FORMA_PAGAMENTO

22)

SELECT i.*
FROM ITENSVENDA i
JOIN VENDA v ON i.ID_VENDA = v.ID_VENDA
JOIN PRODUTO p ON i.ID_PRODUTO = p.ID_PRODUTO
WHERE p.NOME = 'Placa de Captura'

23)

SELECT CAST('Cliente' AS varchar(10)) AS tipo, p.NOME, p.ID_PESSOA, (2025 - EXTRACT(YEAR FROM p.DATA_NASCIMENTO))
FROM PESSOA p
INNER JOIN CLIENTE c ON c.ID_PESSOA = p.ID_PESSOA
UNION
SELECT CAST('Fornecedor' AS varchar(10)) AS tipo, p2.NOME, p2.ID_PESSOA, (2025 - EXTRACT(YEAR FROM p2.DATA_NASCIMENTO))
FROM FORNECEDOR f
INNER JOIN PESSOA p2 ON p2.ID_PESSOA = f.ID_PESSOA





24)

SELECT b.CEP, b.ID_MUNICIPIO, l.NOME, p.NOME
FROM ENDERECO e
LEFT JOIN BAIRRO b ON b.ID_BAIRRO = e.ID_BAIRRO
LEFT JOIN LOGRADOURO l ON l.ID_LOGRADOURO = e.ID_LOGRADOURO
LEFT JOIN PESSOA p ON p.ID_PESSOA = e.ID_PESSOA


25)

SELECT p.*
FROM PRODUTO p
WHERE p.PRECO_UNITARIO > (SELECT AVG(PRECO_UNITARIO) FROM PRODUTO)

26)

SELECT DISTINCT c.*
FROM CLIENTE c
JOIN PESSOA p ON c.ID_PESSOA = p.ID_PESSOA
JOIN ENDERECO e ON p.ID_PESSOA = e.ID_PESSOA
JOIN MUNICIPIO m ON e.ID_MUNICIPIO = m.ID_MUNICIPIO
JOIN VENDA v ON p.ID_PESSOA = v.ID_PESSOA
WHERE m.POPULACAO > 1000000


27)

SELECT f.ID_PESSOA AS FORNECEDOR, SUM(iv.QUANTIDADE) AS TOTAL_PRODUTOS_VENDIDOS
FROM FORNECEDOR f
JOIN PRODUTO p ON f.ID_FORNECEDOR = p.ID_FORNECEDOR
JOIN ITENSVENDA iv ON p.ID_PRODUTO = iv.ID_PRODUTO
GROUP BY f.ID_PESSOA 

28)

SELECT c.ID_CLIENTE AS CLIENTE, SUM(v.VALOR_TOTAL) AS VALOR_TOTAL_COMPRAS
FROM CLIENTE c
JOIN VENDA v ON c.ID_PESSOA = v.ID_PESSOA
GROUP BY c.ID_CLIENTE
HAVING SUM(v.VALOR_TOTAL) > 500



29) 

SELECT p.NOME, e.TIPO_ENDERECO AS TIPO_ENDERECO, e.ID_LOGRADOURO , e.NUMERO
FROM PESSOA p
LEFT JOIN ENDERECO e ON p.ID_PESSOA = e.ID_PESSOA

30)

SELECT p.NOME AS PRODUTO, p.PRECO_UNITARIO, f.ID_FORNECEDOR AS FORNECEDOR
FROM PRODUTO p
LEFT JOIN FORNECEDOR f ON p.ID_FORNECEDOR = f.ID_FORNECEDOR

31)

SELECT NOME, QUANTIDADE_ESTOQUE
FROM PRODUTO
ORDER BY QUANTIDADE_ESTOQUE DESC

32)

SELECT ID_VENDA, DATA_VENDA, VALOR_TOTAL
FROM VENDA
ORDER BY VALOR_TOTAL ASC

33)

SELECT NOME, QUANTIDADE_ESTOQUE
FROM PRODUTO
WHERE QUANTIDADE_ESTOQUE < (SELECT AVG(QUANTIDADE_ESTOQUE) FROM PRODUTO)

34)

SELECT p1.NOME AS PESSOA1, p2.NOME AS PESSOA2, p1.TELEFONE
FROM PESSOA p1
JOIN PESSOA p2 ON p1.TELEFONE = p2.TELEFONE AND p1.ID_PESSOA <> p2.ID_PESSOA

35)

UPDATE PRODUTO p
SET p.PRECO_UNITARIO = p.PRECO_UNITARIO * 1.10
WHERE p.ID_FORNECEDOR IN (
    SELECT f.ID_FORNECEDOR
    FROM FORNECEDOR f
    JOIN ENDERECO e ON f.ID_PESSOA = e.ID_PESSOA
    WHERE e. = 'São Paulo'
)



36)

SELECT v.ID_VENDA, v.DATA_VENDA, d.SITUACAO_DEBITO
FROM VENDA v
JOIN DEBITOS d ON v.ID_VENDA = d.ID_VENDA
WHERE d.SITUACAO_DEBITO = 'Negociado'










